/******************************************************************************/
/*****************  Copyright (c) 2010 by S1nn GmbH & Co. KG  *****************/
/***************************  All Rights Reserved  ****************************/
/******************************************************************************/

/******************************************************************************/
/* File Name:     OSEK_Utils.c
*-----------------------------------------------------------------------------
* Module Name:    MOD_OSEK
*-----------------------------------------------------------------------------
* Description:    
*-----------------------------------------------------------------------------
* $Date: 2009-06-04 08:22:38 +0200 (Do, 04 Jun 2009) $
* $Rev: 6465 $
* $Author: rammelt $
* $URL: http://subversion-01/svn/SW_HW_System/Projects/VW_UHV-NAR/SW/MOD/SYS_OSEK_INTERFACE/trunk/src/OSEK_SystemTask_C1.c $
*-----------------------------------------------------------------------------
*/
/******************************************************************************/

/*----------------------------------------------------------------------------*/
/* System Includes                                                            */
/*----------------------------------------------------------------------------*/
#include <osek.h>

/*----------------------------------------------------------------------------*/
/* Libraries from external Vendors                                            */
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/* Own Header Files                                                           */
/*----------------------------------------------------------------------------*/
#include "Common.h"
#include "OSEK_Utils.h"
#include "OSEK_Utils.id"
#include "TRACE.h"
#include "APP_CAN_IL_DIAGNOSIS.h"

/*----------------------------------------------------------------------------*/
/* pragma Directives                                                          */
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/* Global Variables Definitions (avoid as much as possible!)                  */
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/* Global const Definitions                                                   */
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/* Private Manifest Constant Definitions                                      */
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/* Private Types                                                              */
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/* Prototypes of private Methods                                              */
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/* Private Code Macros                                                        */
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/* Private Variables                                                          */
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/* Private const Definitions                                                  */
/*----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------*/
/* Private Address Calculations                                               */
/*----------------------------------------------------------------------------*/


/*----------------------------------------------------------------------------*/
/* Function :   OSEK_TaskStackStatistic                                       */
/** 
  \brief        Get the current task level of the different tasks  

  \param        none

  \return       none
 */
/*----------------------------------------------------------------------------*/
void OSEK_TaskStackStatistic(void)
{
    Uint8Type i=0;
    Uint8Type pDD00Data[4] = {0};
    Uint16Type totalStack, usedStack;


    APP_CAN_IL_DIAGNOSIS_Get_Global_Real_Time( &pDD00Data[0] );

    DEBUG_TEXT(OSEK_INTERFACE_SWI_TRC, MOD_OSEK_INTERFACE, "Stack statistic:");
    for (i=0; i<osdNumberOfAllTasks; i++)
    {
        totalStack = ((Uint32Type *)oskTcbStackTop[i] - (Uint32Type *)oskTcbStackBottom[i])*4;
        usedStack = osGetStackUsage((TaskType)i);
        DEBUG_STATE1(OSEK_INTERFACE_SWI_TRC, MOD_OSEK_INTERFACE, "$SYS_OSEK_INTERFACE_ENUM_TASKNAMES$ %d",
                     i);
        DEBUG_VALUE2(OSEK_INTERFACE_SWI_TRC, MOD_OSEK_INTERFACE, "Total   [%04d]     Remaining  [%04d]",
                     totalStack, ( totalStack - usedStack ));
    }
    DEBUG_VALUE2(OSEK_INTERFACE_SWI_TRC, MOD_OSEK_INTERFACE, "System:   used: %d  [%d]", 
                 osGetSystemStackUsage(), sizeof(osSystemStack));
}

/* End Of File OSEK_Utils.c */
